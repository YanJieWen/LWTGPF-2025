'''
@File: __init__.py.py
@Software: PyCharm
@Author: Yanjie Wen(MitSui)
@Institution: CSU&BUCEA
@E-mail: obitowen@csu.edu.cn
@Time: 11æœˆ 22, 2024
@HomePage: https://github.com/YanJieWen
'''

from .base_dataset import BaseImageDataset,BaseDataset
from .preprocessor import Preprocessor

__all__ = (
    'BaseImageDataset','BaseDataset','Preprocessor',
)
class IterLoader:
    def __init__(self, loader, length=None):
        self.loader = loader
        self.length = length
        self.iter = None

    def __len__(self):
        if (self.length is not None):
            return self.length
        return len(self.loader)

    def new_epoch(self):
        self.iter = iter(self.loader)

    def next(self):
        try:
            return next(self.iter)
        except:
            self.iter = iter(self.loader)
            return next(self.iter)